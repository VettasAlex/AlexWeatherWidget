<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Alex's Weather Project</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="weather.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>

  <body>
    <div class="container">
      <div class="top-buttons">
        <button id="nowBtn" onclick="selectButton(this)">Now</button>
        <button id="todayBtn" class="today-button" onclick="selectButton(this)">
          Today
        </button>
        <button class="date-button" onclick="selectButton(this)">Date</button>

        <label class="switch">
          <input type="checkbox" id="dark-mode-toggle" />
          <span class="slider"></span>
        </label>
      </div>
      <div id="date-options" class="hidden"></div>
      <div class="weather-display">
        <div class="weather-text">
          <h2 id="main-temp">--°C</h2>
          <h6 id="main-comm">Clear - few clouds</h6>
        </div>
        <img id="weather-icon" src="/icons/caution.png" alt="Weather Icon" />
      </div>
      <button id="logTempBtn" onclick="logTemperature()">
        Log Current Temperature
      </button>
    </div>

    <div class="container">
      <div class="squares">
        <div class="square">
          <h3 id="real-feel">--°C</h3>
          <h5>Real Feel</h5>
        </div>

        <div class="square">
          <h3 id="wind-speed">--m/s</h3>
          <h5>Wind Speed</h5>
        </div>

        <div class="square">
          <h3 id="wind-gust">--m/s</h3>
          <h5>Wind Gust</h5>
        </div>

        <div class="square">
          <h3 id="wind-deg">--°</h3>
          <h5>Wind Deg</h5>
        </div>

        <div class="square">
          <h3 id="humidity">--%</h3>
          <h5>Humidity</h5>
        </div>

        <div class="square">
          <h3 id="pressure">--hPa</h3>
          <h5>Pressure</h5>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="graph">
        <canvas id="weekChart" width="400" height="200"></canvas>
        <div style="text-align: center; margin-bottom: 10px"></div>
      </div>
    </div>

    <script src="weather.js" async defer></script>

    <!-- Fetch POST for logTempBtn click -->
    <script>
      document
        .getElementById("logTempBtn")
        .addEventListener("click", function () {
          fetch("http://localhost:8080/trigger-fetch", {
            method: "POST",
          })
            .then((res) => res.text())
            .then((data) => alert(data))
            .catch((err) => console.error("Fetch failed:", err));
        });
    </script>
  </body>
</html>
